<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MedConnect - Real-Time Medical Rep Marketplace</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2196F3 0%, #1976D2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .live-stats-bar {
            background: #f8f9fa;
            padding: 20px;
            display: flex;
            justify-content: space-around;
            border-bottom: 1px solid #e9ecef;
        }

        .stat {
            text-align: center;
        }

        .stat-number {
            font-size: 1.8rem;
            font-weight: bold;
            color: #2196F3;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #6c757d;
            margin-top: 5px;
        }

        .online-indicator {
            color: #28a745;
            font-weight: bold;
        }

        .main-content {
            padding: 30px;
        }

        /* Features Showcase Styles */
        .features-showcase {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 40px 30px;
            margin: 20px 0;
            border-radius: 15px;
            border: 1px solid #e9ecef;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-top: 20px;
        }

        .feature-card {
            background: white;
            padding: 30px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 8px 25px rgba(0,0,0,0.08);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border-left: 5px solid #2196F3;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.15);
        }

        .feature-icon {
            width: 70px;
            height: 70px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            font-size: 2rem;
            background: #2196F3;
            color: white;
        }

        .feature-card h4 {
            font-size: 1.2rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 15px;
            line-height: 1.3;
        }

        .feature-card p {
            font-size: 0.95rem;
            color: #666;
            line-height: 1.5;
            margin: 0;
        }

        .role-tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            border-radius: 10px;
            background: #f1f3f4;
            padding: 5px;
            flex-wrap: wrap;
        }

        .role-tab {
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            margin: 2px;
        }

        .role-tab.active {
            background: #2196F3;
            color: white;
        }

        .role-tab:not(.active) {
            color: #6c757d;
        }

        .role-tab:hover:not(.active) {
            background: #e9ecef;
        }

        .demo-panel {
            display: none;
        }

        .demo-panel.active {
            display: block;
        }

        .pharma-dashboard {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 30px;
            margin-top: 20px;
        }

        .quota-panel {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 12px;
            border-left: 5px solid #2196F3;
        }

        .quota-title {
            font-size: 1.3rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 15px;
        }

        .quota-progress {
            background: #e9ecef;
            border-radius: 10px;
            height: 20px;
            margin: 10px 0;
            overflow: hidden;
        }

        .quota-fill {
            background: linear-gradient(135deg, #28a745, #20c997);
            height: 100%;
            transition: width 0.3s ease;
        }

        .live-doctors-feed {
            background: white;
            border-radius: 12px;
            border: 2px solid #e9ecef;
        }

        .feed-header {
            background: #2196F3;
            color: white;
            padding: 15px 20px;
            border-radius: 10px 10px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .doctor-card {
            padding: 15px 20px;
            border-bottom: 1px solid #f1f3f4;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background-color 0.3s ease;
        }

        .doctor-card:hover {
            background-color: #f8f9fa;
        }

        .doctor-card:last-child {
            border-bottom: none;
        }

        .doctor-card.offline {
            opacity: 0.6;
        }

        .doctor-info {
            flex: 1;
        }

        .doctor-name {
            font-weight: 600;
            color: #333;
            font-size: 1.1rem;
        }

        .doctor-specialty {
            color: #6c757d;
            font-size: 0.9rem;
        }

        .doctor-hospital {
            color: #2196F3;
            font-size: 0.8rem;
            margin-top: 2px;
        }

        .online-status {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #28a745;
            animation: pulse 2s infinite;
        }

        .status-indicator.offline {
            background: #6c757d;
            animation: none;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .online-duration {
            font-size: 0.8rem;
            color: #28a745;
            font-weight: 500;
        }

        .offline-text {
            font-size: 0.8rem;
            color: #6c757d;
            font-weight: 500;
        }

        .call-now-btn {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: transform 0.3s ease;
        }

        .call-now-btn:hover {
            transform: translateY(-2px);
        }

        .call-now-btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
            transform: none;
        }

        /* Pagination Styles */
        .pagination-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: #f8f9fa;
            border-top: 1px solid #e9ecef;
        }

        .pagination {
            display: flex;
            gap: 5px;
            align-items: center;
        }

        .pagination-btn {
            background: #2196F3;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background 0.3s ease;
        }

        .pagination-btn:hover:not(:disabled) {
            background: #1976D2;
        }

        .pagination-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .pagination-btn.active {
            background: #1976D2;
            font-weight: bold;
        }

        .pagination-info {
            font-size: 0.9rem;
            color: #6c757d;
        }

        .doctor-dashboard {
            text-align: center;
            padding: 40px;
        }

        .online-toggle {
            background: #28a745;
            color: white;
            border: none;
            padding: 20px 40px;
            border-radius: 50px;
            font-size: 1.5rem;
            cursor: pointer;
            margin: 20px;
            transition: all 0.3s ease;
        }

        .online-toggle.offline {
            background: #6c757d;
        }

        .session-info {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }

        .session-stat {
            text-align: center;
        }

        .session-number {
            font-size: 1.5rem;
            font-weight: bold;
            color: #2196F3;
        }

        .session-label {
            font-size: 0.9rem;
            color: #6c757d;
            margin-top: 5px;
        }

        .incoming-calls {
            background: white;
            border-radius: 12px;
            border: 2px solid #ffc107;
            margin-top: 20px;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
        }

        .call-request {
            padding: 15px;
            border-bottom: 1px solid #f1f3f4;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .call-request:last-child {
            border-bottom: none;
        }

        .caller-info {
            flex: 1;
        }

        .caller-name {
            font-weight: 600;
            color: #333;
        }

        .caller-company {
            color: #6c757d;
            font-size: 0.9rem;
        }

        .call-actions {
            display: flex;
            gap: 10px;
        }

        .accept-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
        }

        .decline-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
        }

        .video-modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }

        .video-modal-content {
            background-color: white;
            margin: 2% auto;
            padding: 20px;
            border-radius: 15px;
            width: 90%;
            max-width: 800px;
            position: relative;
            max-height: 90vh;
            overflow-y: auto;
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close:hover {
            color: black;
        }

        .main-video-area {
            background: #000;
            border-radius: 10px;
            margin: 20px 0;
            height: 400px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .video-content {
            font-size: 1.2rem;
            z-index: 2;
            position: relative;
        }

        .screen-share-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: #1a1a1a;
            color: white;
            display: none;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            z-index: 1;
        }

        .screen-share-overlay.active {
            display: flex;
        }

        .video-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            margin-top: 10px;
        }

        .btn {
            background: linear-gradient(135deg, #2196F3, #1976D2);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: transform 0.3s ease;
            margin: 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .btn-danger {
            background: linear-gradient(135deg, #dc3545, #c82333);
        }

        .filter-bar {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
        }

        .filter-select {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 0.9rem;
        }

        .refresh-btn {
            background: #17a2b8;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
        }

        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .analytics-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            border-left: 5px solid #2196F3;
        }

        .analytics-number {
            font-size: 2rem;
            font-weight: bold;
            color: #2196F3;
        }

        .analytics-label {
            color: #6c757d;
            margin-top: 5px;
        }

        /* Enhanced Analytics Section */
        .analytics-boxes {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }

        .analytics-box {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            border-left: 6px solid;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .analytics-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.15);
        }

        .analytics-box.scheduling { border-color: #2196F3; }
        .analytics-box.meeting-duration { border-color: #4CAF50; }
        .analytics-box.no-show { border-color: #FF5722; }
        .analytics-box.territory { border-color: #FF9800; }
        .analytics-box.video { border-color: #9C27B0; }
        .analytics-box.satisfaction { border-color: #00BCD4; }

        .analytics-box-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .analytics-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 1.5rem;
        }

        .analytics-icon.scheduling { background: rgba(33, 150, 243, 0.1); color: #2196F3; }
        .analytics-icon.meeting-duration { background: rgba(76, 175, 80, 0.1); color: #4CAF50; }
        .analytics-icon.no-show { background: rgba(255, 87, 34, 0.1); color: #FF5722; }
        .analytics-icon.territory { background: rgba(255, 152, 0, 0.1); color: #FF9800; }
        .analytics-icon.video { background: rgba(156, 39, 176, 0.1); color: #9C27B0; }
        .analytics-icon.satisfaction { background: rgba(0, 188, 212, 0.1); color: #00BCD4; }

        .analytics-box-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: #333;
            margin: 0;
        }

        .analytics-box-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #333;
            margin: 10px 0;
        }

        .analytics-box-description {
            font-size: 0.9rem;
            color: #666;
            line-height: 1.4;
        }

        /* Summary cards at bottom */
        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .summary-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            border-top: 4px solid;
        }

        .summary-card.blue { border-color: #3498db; }
        .summary-card.purple { border-color: #9b59b6; }
        .summary-card.green { border-color: #2ecc71; }
        .summary-card.orange { border-color: #f39c12; }

        .summary-card-number {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .summary-card.blue .summary-card-number { color: #3498db; }
        .summary-card.purple .summary-card-number { color: #9b59b6; }
        .summary-card.green .summary-card-number { color: #2ecc71; }
        .summary-card.orange .summary-card-number { color: #f39c12; }

        .summary-card-label {
            font-size: 0.9rem;
            color: #7f8c8d;
            font-weight: 500;
        }

        @media (max-width: 768px) {
            .pharma-dashboard {
                grid-template-columns: 1fr;
            }
            
            .live-stats-bar {
                flex-direction: column;
                gap: 15px;
            }
            
            .role-tabs {
                flex-direction: column;
            }

            .video-controls {
                flex-direction: column;
                gap: 5px;
            }

            .video-modal-content {
                width: 95%;
                margin: 5% auto;
            }

            .main-video-area {
                height: 300px;
            }

            .analytics-boxes {
                grid-template-columns: 1fr;
            }

            .features-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .features-showcase {
                padding: 30px 20px;
            }

            .feature-card {
                padding: 25px;
            }

            .pagination {
                flex-wrap: wrap;
                gap: 3px;
            }

            .pagination-container {
                flex-direction: column;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🏥 MedConnect</h1>
            <p>Real-Time Medical Rep Marketplace - Instant Video Consultations</p>
        </div>

        <div class="live-stats-bar">
            <div class="stat">
                <div class="stat-number online-indicator" id="onlineDoctors">47</div>
                <div class="stat-label">Doctors Online Now</div>
            </div>
            <div class="stat">
                <div class="stat-number" id="todayCalls">847</div>
                <div class="stat-label">Calls Completed Today</div>
            </div>
            <div class="stat">
                <div class="stat-number" id="activePharma">18</div>
                <div class="stat-label">Pharma Companies Active</div>
            </div>
            <div class="stat">
                <div class="stat-number" id="avgCallTime">4.2 min</div>
                <div class="stat-label">Average Call Duration</div>
            </div>
        </div>

        <div class="main-content">
            <!-- Features Showcase Section -->
            <div class="features-showcase">
                <div class="features-grid">
                    <div class="feature-card">
                        <div class="feature-icon scheduling">📅</div>
                        <h4>Smart Scheduling Engine</h4>
                        <p>AI-powered scheduling with 75% conflict reduction</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon priority">🎯</div>
                        <h4>Priority-Based Booking</h4>
                        <p>Doctor-controlled consultation windows and capacity</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon notifications">🔔</div>
                        <h4>Automated Notifications</h4>
                        <p>Multi-channel reminders reducing no-shows by 60%</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon analytics">📊</div>
                        <h4>Analytics Dashboard</h4>
                        <p>Data-driven insights for field force optimization</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon video">📹</div>
                        <h4>Video Consultation & Screen Sharing</h4>
                        <p>Virtual meetings with presentation capabilities</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon location">📍</div>
                        <h4>Multi-Location Support</h4>
                        <p>GPS-verified check-ins and route optimization</p>
                    </div>
                </div>
            </div>

            <div class="role-tabs">
                <div class="role-tab active" onclick="switchRole('pharma', event)">💊 Pharma Company</div>
                <div class="role-tab" onclick="switchRole('doctor', event)">👨‍⚕️ Doctor Dashboard</div>
                <div class="role-tab" onclick="switchRole('admin', event)">📊 System Analytics</div>
            </div>

            <!-- Pharma Company Dashboard -->
            <div id="pharma-panel" class="demo-panel active">
                <h3>Pfizer India - Daily Operations Center</h3>
                
                <div class="pharma-dashboard">
                    <div class="quota-panel">
                        <div class="quota-title">Today's Call Quota</div>
                        <div style="display: flex; justify-content: space-between; align-items: center; margin: 15px 0;">
                            <span style="font-size: 2rem; font-weight: bold; color: #2196F3;" id="completedCalls">23</span>
                            <span style="font-size: 1.2rem; color: #6c757d;" id="quotaTarget">/ 50 calls</span>
                        </div>
                        <div class="quota-progress">
                            <div class="quota-fill" style="width: 46%;" id="quotaProgress"></div>
                        </div>
                        <div style="margin-top: 20px;">
                            <label style="display: block; margin-bottom: 10px; font-weight: 600;">Set Daily Target:</label>
                            <select class="filter-select" onchange="updateQuota(this.value)">
                                <option value="30">30 calls</option>
                                <option value="40">40 calls</option>
                                <option value="50" selected>50 calls</option>
                                <option value="60">60 calls</option>
                            </select>
                        </div>
                        
                        <div style="margin-top: 20px;">
                            <div style="font-size: 0.9rem; color: #6c757d;">Active Reps: 8</div>
                            <div style="font-size: 0.9rem; color: #6c757d;">Avg calls per rep: 2.9</div>
                            <div style="font-size: 0.9rem; color: #28a745;">On track to complete target</div>
                        </div>
                    </div>

                    <div class="live-doctors-feed">
                        <div class="feed-header">
                            <span>Live Doctor Feed</span>
                            <button class="refresh-btn" onclick="refreshDoctorFeed()">🔄 Refresh</button>
                        </div>
                        
                        <div class="filter-bar">
                            <select class="filter-select" onchange="filterBySpecialty(this.value)">
                                <option value="all">All Specialties</option>
                                <option value="cardiologist">Cardiology</option>
                                <option value="neurophysician">Neurology</option>
                                <option value="orthopedic">Orthopedics</option>
                                <option value="gastroenterologist">Gastroenterology</option>
                                <option value="dermatologist">Dermatology</option>
                                <option value="pulmonologist">Pulmonology</option>
                                <option value="endocrinologist">Endocrinology</option>
                                <option value="pediatrician">Pediatrics</option>
                                <option value="psychiatrist">Psychiatry</option>
                                <option value="urologist">Urology</option>
                            </select>
                            <select class="filter-select" onchange="filterByHospital(this.value)">
                                <option value="all">All Hospitals</option>
                                <option value="apollo jubilee">Apollo Jubilee Hills</option>
                                <option value="apollo secunderabad">Apollo Secunderabad</option>
                                <option value="care banjara">Care Banjara Hills</option>
                                <option value="care hitech">Care Hi-Tech City</option>
                                <option value="nims">NIMS Hospital</option>
                                <option value="sunshine">Sunshine Hospitals</option>
                                <option value="continental">Continental Hospitals</option>
                                <option value="yashoda">Yashoda Hospitals</option>
                                <option value="rainbow">Rainbow Children's Hospital</option>
                                <option value="kims">KIMS Hospitals</option>
                                <option value="max cure">Max Cure Hospitals</option>
                                <option value="global">Global Hospitals</option>
                            </select>
                            <select class="filter-select" onchange="filterByStatus(this.value)">
                                <option value="all">All Status</option>
                                <option value="online">Online Only</option>
                                <option value="offline">Offline Only</option>
                            </select>
                        </div>
                        
                        <div id="doctorFeed">
                            <!-- Dynamic content loaded here -->
                        </div>
                        
                        <!-- Pagination -->
                        <div class="pagination-container">
                            <div class="pagination-info">
                                <span id="paginationInfo">Showing 1-5 of 150 doctors</span>
                            </div>
                            <div class="pagination">
                                <button class="pagination-btn" onclick="changePage('prev')" id="prevBtn">← Previous</button>
                                <button class="pagination-btn active" onclick="goToPage(1)">1</button>
                                <button class="pagination-btn" onclick="goToPage(2)">2</button>
                                <button class="pagination-btn" onclick="goToPage(3)">3</button>
                                <button class="pagination-btn" onclick="goToPage(4)">4</button>
                                <button class="pagination-btn" onclick="goToPage(5)">5</button>
                                <span style="padding: 0 10px;">...</span>
                                <button class="pagination-btn" onclick="goToPage(30)">30</button>
                                <button class="pagination-btn" onclick="changePage('next')" id="nextBtn">Next →</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Doctor Dashboard -->
            <div id="doctor-panel" class="demo-panel">
                <div class="doctor-dashboard">
                    <h3>Dr. Ashwin - Cardiology (Apollo Hospital Jubilee Hill)</h3>
                    
                    <button class="online-toggle offline" id="statusToggle" onclick="toggleOnlineStatus()">
                        🟢 GO ONLINE
                    </button>
                    
                    <div class="session-info">
                        <div class="session-stat">
                            <div class="session-number" id="sessionCalls">0</div>
                            <div class="session-label">Calls This Session</div>
                        </div>
                        <div class="session-stat">
                            <div class="session-number" id="sessionDuration">0:00</div>
                            <div class="session-label">Time Online</div>
                        </div>
                        <div class="session-stat">
                            <div class="session-number" id="todayEarnings">₹0</div>
                            <div class="session-label">Today's Earnings</div>
                        </div>
                        <div class="session-stat">
                            <div class="session-number" id="callsRemaining">5</div>
                            <div class="session-label">Calls Remaining</div>
                        </div>
                    </div>

                    <div style="margin: 20px 0;">
                        <label style="font-weight: 600; margin-right: 10px;">Session Limit:</label>
                        <select onchange="setSessionLimit(this.value)">
                            <option value="3">3 calls per session</option>
                            <option value="5" selected>5 calls per session</option>
                            <option value="8">8 calls per session</option>
                            <option value="10">10 calls per session</option>
                        </select>
                    </div>

                    <div class="incoming-calls" id="incomingCalls" style="display: none;">
                        <div style="background: #ffc107; color: #856404; padding: 10px; text-align: center; font-weight: 600;">
                            📞 Incoming Call Requests
                        </div>
                        <div id="callRequests">
                            <!-- Call requests appear here when online -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- System Analytics -->
            <div id="admin-panel" class="demo-panel">
                <h3>MedConnect System Analytics - Telangana Region</h3>
                
                <!-- Enhanced Analytics Boxes -->
                <div class="analytics-boxes">
                    <div class="analytics-box scheduling">
                        <div class="analytics-box-header">
                            <div class="analytics-icon scheduling">📅</div>
                            <h4 class="analytics-box-title">Scheduling Efficiency</h4>
                        </div>
                        <div class="analytics-box-value">89%</div>
                        <div class="analytics-box-description">appointments confirmed within 24 hours</div>
                    </div>

                    <div class="analytics-box meeting-duration">
                        <div class="analytics-box-header">
                            <div class="analytics-icon meeting-duration">⏱️</div>
                            <h4 class="analytics-box-title">Average Meeting Duration</h4>
                        </div>
                        <div class="analytics-box-value">5.8 min</div>
                        <div class="analytics-box-description">Increased from 3.2 to 5.8 minutes</div>
                    </div>

                    <div class="analytics-box no-show">
                        <div class="analytics-box-header">
                            <div class="analytics-icon no-show">🎯</div>
                            <h4 class="analytics-box-title">No-Show Reduction</h4>
                        </div>
                        <div class="analytics-box-value">67%</div>
                        <div class="analytics-box-description">Decreased by 67% with automated reminders</div>
                    </div>

                    <div class="analytics-box territory">
                        <div class="analytics-box-header">
                            <div class="analytics-icon territory">🗺️</div>
                            <h4 class="analytics-box-title">Territory Optimization</h4>
                        </div>
                        <div class="analytics-box-value">31%</div>
                        <div class="analytics-box-description">reduction in travel time</div>
                    </div>

                    <div class="analytics-box video">
                        <div class="analytics-box-header">
                            <div class="analytics-icon video">📹</div>
                            <h4 class="analytics-box-title">Video Consultations</h4>
                        </div>
                        <div class="analytics-box-value">78%</div>
                        <div class="analytics-box-description">include screen sharing presentations</div>
                    </div>

                    <div class="analytics-box satisfaction">
                        <div class="analytics-box-header">
                            <div class="analytics-icon satisfaction">⭐</div>
                            <h4 class="analytics-box-title">Doctor Satisfaction</h4>
                        </div>
                        <div class="analytics-box-value">94%</div>
                        <div class="analytics-box-description">rate system as "Excellent"</div>
                    </div>
                </div>

                <!-- Summary Cards -->
                <div class="summary-cards">
                    <div class="summary-card blue">
                        <div class="summary-card-number">2,847</div>
                        <div class="summary-card-label">Total Appointments This Month</div>
                    </div>
                    <div class="summary-card purple">
                        <div class="summary-card-number">127</div>
                        <div class="summary-card-label">Active Medical Reps</div>
                    </div>
                    <div class="summary-card green">
                        <div class="summary-card-number">89</div>
                        <div class="summary-card-label">Participating Doctors</div>
                    </div>
                    <div class="summary-card orange">
                        <div class="summary-card-number">7</div>
                        <div class="summary-card-label">Hospitals & Clinics</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Video Meeting Modal -->
    <div id="videoModal" class="video-modal">
        <div class="video-modal-content">
            <span class="close" onclick="closeVideoModal()">&times;</span>
            <h2 id="videoTitle">Video Consultation</h2>
            
            <div class="main-video-area" id="mainVideoArea">
                <div class="video-content" id="videoContent">
                    📹 Connecting...
                </div>
                
                <div class="screen-share-overlay" id="screenShareOverlay">
                    <div style="font-size: 3rem;">📊</div>
                    <div style="font-size: 1.5rem; margin: 10px 0;">Product Presentation</div>
                    <div style="font-size: 1rem; color: #666;">Medical Rep is sharing screen</div>
                </div>
            </div>
            
            <div class="video-controls">
                <button class="btn" onclick="toggleMute()">🎤 Mute</button>
                <button class="btn" onclick="toggleCamera()">📹 Camera</button>
                <button class="btn" onclick="toggleScreenShare()" id="shareScreenBtn">📺 Share Screen</button>
                <button class="btn btn-danger" onclick="endCall()">End Call</button>
            </div>
        </div>
    </div>

    <script>
        // Enhanced doctor data with more doctors and mixed online/offline status
        let doctorsData = [
            // Apollo Jubilee Hills
            {id: 1, name: "Dr. Ashwin Kumar", specialty: "cardiologist", hospital: "apollo jubilee", isOnline: true, onlineSince: new Date(Date.now() - 1200000), callsToday: 8},
            {id: 2, name: "Dr. Mahesh Reddy", specialty: "neurophysician", hospital: "apollo jubilee", isOnline: true, onlineSince: new Date(Date.now() - 300000), callsToday: 3},
            {id: 3, name: "Dr. Suresh Babu", specialty: "orthopedic", hospital: "apollo jubilee", isOnline: true, onlineSince: new Date(Date.now() - 1500000), callsToday: 7},
            {id: 4, name: "Dr. Anitha Reddy", specialty: "pulmonologist", hospital: "apollo jubilee", isOnline: true, onlineSince: new Date(Date.now() - 750000), callsToday: 8},
            {id: 5, name: "Dr. Venkat Rao", specialty: "dermatologist", hospital: "apollo jubilee", isOnline: true, onlineSince: new Date(Date.now() - 180000), callsToday: 2},
            
            // Apollo Secunderabad
            {id: 6, name: "Dr. Priya Nair", specialty: "endocrinologist", hospital: "apollo secunderabad", isOnline: false, onlineSince: null, callsToday: 5},
            {id: 7, name: "Dr. Ramesh Gupta", specialty: "cardiologist", hospital: "apollo secunderabad", isOnline: true, onlineSince: new Date(Date.now() - 900000), callsToday: 6},
            {id: 8, name: "Dr. Kavitha Singh", specialty: "pediatrician", hospital: "apollo secunderabad", isOnline: true, onlineSince: new Date(Date.now() - 600000), callsToday: 4},
            
            // Care Banjara Hills
            {id: 9, name: "Dr. Priya Sharma", specialty: "orthopedic", hospital: "care banjara", isOnline: true, onlineSince: new Date(Date.now() - 900000), callsToday: 12},
            {id: 10, name: "Dr. Sneha Patel", specialty: "cardiologist", hospital: "care banjara", isOnline: true, onlineSince: new Date(Date.now() - 600000), callsToday: 9},
            {id: 11, name: "Dr. Vijay Kumar", specialty: "dermatologist", hospital: "care banjara", isOnline: false, onlineSince: null, callsToday: 2},
            {id: 12, name: "Dr. Deepika Agarwal", specialty: "gastroenterologist", hospital: "care banjara", isOnline: false, onlineSince: null, callsToday: 7},
            
            // Care Hi-Tech City
            {id: 13, name: "Dr. Ravi Krishnan", specialty: "neurophysician", hospital: "care hitech", isOnline: true, onlineSince: new Date(Date.now() - 1200000), callsToday: 5},
            {id: 14, name: "Dr. Sunita Rao", specialty: "psychiatrist", hospital: "care hitech", isOnline: false, onlineSince: null, callsToday: 3},
            {id: 15, name: "Dr. Arun Reddy", specialty: "urologist", hospital: "care hitech", isOnline: true, onlineSince: new Date(Date.now() - 450000), callsToday: 8},
            
            // NIMS Hospital
            {id: 16, name: "Dr. Ravi Gupta", specialty: "gastroenterologist", hospital: "nims", isOnline: false, onlineSince: null, callsToday: 6},
            {id: 17, name: "Dr. Meera Singh", specialty: "neurophysician", hospital: "nims", isOnline: false, onlineSince: null, callsToday: 3},
            {id: 18, name: "Dr. Ramesh Chandra", specialty: "orthopedic", hospital: "nims", isOnline: false, onlineSince: null, callsToday: 5},
            {id: 19, name: "Dr. Lakshmi Devi", specialty: "endocrinologist", hospital: "nims", isOnline: true, onlineSince: new Date(Date.now() - 1800000), callsToday: 6},
            
            // Sunshine Hospitals
            {id: 20, name: "Dr. Anil Varma", specialty: "dermatologist", hospital: "sunshine", isOnline: true, onlineSince: new Date(Date.now() - 2100000), callsToday: 5},
            {id: 21, name: "Dr. Sita Mahalakshmi", specialty: "cardiologist", hospital: "sunshine", isOnline: true, onlineSince: new Date(Date.now() - 1050000), callsToday: 10},
            {id: 22, name: "Dr. Sowmya Reddy", specialty: "pulmonologist", hospital: "sunshine", isOnline: false, onlineSince: null, callsToday: 6},
            {id: 23, name: "Dr. Prakash Jain", specialty: "pediatrician", hospital: "sunshine", isOnline: true, onlineSince: new Date(Date.now() - 300000), callsToday: 4},
            
            // Continental Hospitals
            {id: 24, name: "Dr. Rajesh Krishnan", specialty: "cardiologist", hospital: "continental", isOnline: true, onlineSince: new Date(Date.now() - 450000), callsToday: 11},
            {id: 25, name: "Dr. Kiran Prabhu", specialty: "neurophysician", hospital: "continental", isOnline: true, onlineSince: new Date(Date.now() - 2400000), callsToday: 4},
            {id: 26, name: "Dr. Harish Babu", specialty: "orthopedic", hospital: "continental", isOnline: true, onlineSince: new Date(Date.now() - 1320000), callsToday: 9},
            {id: 27, name: "Dr. Shweta Gupta", specialty: "psychiatrist", hospital: "continental", isOnline: false, onlineSince: null, callsToday: 2},
            
            // Yashoda Hospitals
            {id: 28, name: "Dr. Mohan Das", specialty: "gastroenterologist", hospital: "yashoda", isOnline: true, onlineSince: new Date(Date.now() - 800000), callsToday: 7},
            {id: 29, name: "Dr. Radha Krishna", specialty: "urologist", hospital: "yashoda", isOnline: false, onlineSince: null, callsToday: 3},
            {id: 30, name: "Dr. Sangeetha Rao", specialty: "endocrinologist", hospital: "yashoda", isOnline: true, onlineSince: new Date(Date.now() - 1100000), callsToday: 8},
            
            // Rainbow Children's Hospital
            {id: 31, name: "Dr. Varun Kumar", specialty: "pediatrician", hospital: "rainbow", isOnline: true, onlineSince: new Date(Date.now() - 600000), callsToday: 12},
            {id: 32, name: "Dr. Preeti Sharma", specialty: "pediatrician", hospital: "rainbow", isOnline: true, onlineSince: new Date(Date.now() - 900000), callsToday: 8},
            {id: 33, name: "Dr. Ajay Reddy", specialty: "pediatrician", hospital: "rainbow", isOnline: false, onlineSince: null, callsToday: 5},
            
            // KIMS Hospitals
            {id: 34, name: "Dr. Srinivas Rao", specialty: "cardiologist", hospital: "kims", isOnline: true, onlineSince: new Date(Date.now() - 1800000), callsToday: 9},
            {id: 35, name: "Dr. Geeta Reddy", specialty: "dermatologist", hospital: "kims", isOnline: false, onlineSince: null, callsToday: 4},
            {id: 36, name: "Dr. Prasad Kumar", specialty: "orthopedic", hospital: "kims", isOnline: true, onlineSince: new Date(Date.now() - 400000), callsToday: 6},
            
            // Max Cure Hospitals
            {id: 37, name: "Dr. Naveen Reddy", specialty: "neurophysician", hospital: "max cure", isOnline: true, onlineSince: new Date(Date.now() - 1500000), callsToday: 7},
            {id: 38, name: "Dr. Madhavi Singh", specialty: "gastroenterologist", hospital: "max cure", isOnline: false, onlineSince: null, callsToday: 3},
            {id: 39, name: "Dr. Kishore Babu", specialty: "pulmonologist", hospital: "max cure", isOnline: true, onlineSince: new Date(Date.now() - 700000), callsToday: 5},
            
            // Global Hospitals
            {id: 40, name: "Dr. Ravi Teja", specialty: "urologist", hospital: "global", isOnline: true, onlineSince: new Date(Date.now() - 2000000), callsToday: 6},
            {id: 41, name: "Dr. Swathi Reddy", specialty: "psychiatrist", hospital: "global", isOnline: false, onlineSince: null, callsToday: 2},
            {id: 42, name: "Dr. Venkatesh Kumar", specialty: "endocrinologist", hospital: "global", isOnline: true, onlineSince: new Date(Date.now() - 300000), callsToday: 8}
        ];

        // Add more doctors to reach 150+ total
        let additionalDoctors = [];
        const specialties = ["cardiologist", "neurophysician", "orthopedic", "gastroenterologist", "dermatologist", "pulmonologist", "endocrinologist", "pediatrician", "psychiatrist", "urologist"];
        const hospitals = ["apollo jubilee", "apollo secunderabad", "care banjara", "care hitech", "nims", "sunshine", "continental", "yashoda", "rainbow", "kims", "max cure", "global"];
        const firstNames = ["Dr. Arjun", "Dr. Bhavana", "Dr. Chetan", "Dr. Divya", "Dr. Eshan", "Dr. Falguni", "Dr. Gaurav", "Dr. Hema", "Dr. Isha", "Dr. Jagan"];
        const lastNames = ["Sharma", "Reddy", "Kumar", "Singh", "Rao", "Gupta", "Patel", "Nair", "Jain", "Das"];

        for (let i = 43; i <= 150; i++) {
            const firstName = firstNames[Math.floor(Math.random() * firstNames.length)];
            const lastName = lastNames[Math.floor(Math.random() * lastNames.length)];
            const specialty = specialties[Math.floor(Math.random() * specialties.length)];
            const hospital = hospitals[Math.floor(Math.random() * hospitals.length)];
            const isOnline = Math.random() > 0.4; // 60% chance of being online
            
            additionalDoctors.push({
                id: i,
                name: `${firstName} ${lastName}`,
                specialty: specialty,
                hospital: hospital,
                isOnline: isOnline,
                onlineSince: isOnline ? new Date(Date.now() - Math.random() * 3600000) : null,
                callsToday: Math.floor(Math.random() * 15)
            });
        }

        doctorsData = [...doctorsData, ...additionalDoctors];

        let currentUser = {
            type: 'pharma',
            completedCalls: 23,
            dailyTarget: 50,
            isOnline: false,
            sessionCalls: 0,
            sessionStart: null,
            earnings: 0,
            sessionLimit: 5
        };

        let onlineTimer = null;
        let selectedSpecialty = "all";
        let selectedHospital = "all";
        let selectedStatus = "all";
        let currentPage = 1;
        let doctorsPerPage = 5;

        // Role switching
        function switchRole(role, event) {
            document.querySelectorAll('.role-tab').forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');

            document.querySelectorAll('.demo-panel').forEach(panel => panel.classList.remove('active'));
            document.getElementById(role + '-panel').classList.add('active');
        }

        // Pharma dashboard functions
        function updateQuota(newTarget) {
            currentUser.dailyTarget = parseInt(newTarget);
            document.getElementById('quotaTarget').textContent = `/ ${newTarget} calls`;
            updateQuotaDisplay();
            showNotification(`Daily target updated to ${newTarget} calls`, 'info');
        }

        function updateQuotaDisplay() {
            const percentage = (currentUser.completedCalls / currentUser.dailyTarget) * 100;
            document.getElementById('quotaProgress').style.width = percentage + '%';
            document.getElementById('completedCalls').textContent = currentUser.completedCalls;
        }

        function refreshDoctorFeed() {
            loadDoctorFeed();
            showNotification('Doctor feed refreshed', 'info');
        }

        function getFilteredDoctors() {
            return doctorsData.filter(doc => {
                if (selectedSpecialty !== "all" && doc.specialty !== selectedSpecialty) return false;
                if (selectedHospital !== "all" && doc.hospital !== selectedHospital) return false;
                if (selectedStatus !== "all" && selectedStatus === "online" && !doc.isOnline) return false;
                if (selectedStatus !== "all" && selectedStatus === "offline" && doc.isOnline) return false;
                return true;
            });
        }

        function loadDoctorFeed() {
            const feedContainer = document.getElementById('doctorFeed');
            feedContainer.innerHTML = '';

            const filteredDoctors = getFilteredDoctors();
            const totalPages = Math.ceil(filteredDoctors.length / doctorsPerPage);
            const startIndex = (currentPage - 1) * doctorsPerPage;
            const endIndex = startIndex + doctorsPerPage;
            const doctorsToShow = filteredDoctors.slice(startIndex, endIndex);

            const onlineDoctors = filteredDoctors.filter(doc => doc.isOnline);

            doctorsToShow.forEach(doctor => {
                const onlineDuration = doctor.isOnline ? getOnlineDuration(doctor.onlineSince) : null;

                const doctorCard = document.createElement('div');
                doctorCard.className = `doctor-card ${!doctor.isOnline ? 'offline' : ''}`;
                doctorCard.innerHTML = `
                <div class="doctor-info">
                    <div class="doctor-name">${doctor.name}</div>
                    <div class="doctor-specialty">${capitalize(doctor.specialty)}</div>
                    <div class="doctor-hospital">${capitalize(doctor.hospital)}</div>
                </div>
                <div class="online-status">
                    ${doctor.isOnline ? 
                        `<div class="online-duration">Online ${onlineDuration}</div>
                         <div class="status-indicator"></div>
                         <button class="call-now-btn" onclick="initiateCall('${doctor.name}', '${capitalize(doctor.specialty)}')">
                             📞 Call Now
                         </button>` :
                        `<div class="offline-text">Offline</div>
                         <div class="status-indicator offline"></div>
                         <button class="call-now-btn" disabled>
                             📞 Offline
                         </button>`
                    }
                </div>
                `;
                feedContainer.appendChild(doctorCard);
            });

            updatePaginationControls(filteredDoctors.length, totalPages);
            document.getElementById('onlineDoctors').textContent = onlineDoctors.length;
        }

        function updatePaginationControls(totalDoctors, totalPages) {
            const startIndex = (currentPage - 1) * doctorsPerPage + 1;
            const endIndex = Math.min(currentPage * doctorsPerPage, totalDoctors);
            
            document.getElementById('paginationInfo').textContent = 
                `Showing ${startIndex}-${endIndex} of ${totalDoctors} doctors`;

            // Update pagination buttons
            const pagination = document.querySelector('.pagination');
            pagination.innerHTML = `
                <button class="pagination-btn" onclick="changePage('prev')" id="prevBtn" ${currentPage === 1 ? 'disabled' : ''}>← Previous</button>
            `;

            // Add page numbers
            const maxVisiblePages = 5;
            let startPage = Math.max(1, currentPage - Math.floor(maxVisiblePages / 2));
            let endPage = Math.min(totalPages, startPage + maxVisiblePages - 1);

            if (endPage - startPage < maxVisiblePages - 1) {
                startPage = Math.max(1, endPage - maxVisiblePages + 1);
            }

            for (let i = startPage; i <= endPage; i++) {
                pagination.innerHTML += `
                    <button class="pagination-btn ${i === currentPage ? 'active' : ''}" onclick="goToPage(${i})">${i}</button>
                `;
            }

            if (endPage < totalPages) {
                if (endPage < totalPages - 1) {
                    pagination.innerHTML += `<span style="padding: 0 10px;">...</span>`;
                }
                pagination.innerHTML += `
                    <button class="pagination-btn" onclick="goToPage(${totalPages})">${totalPages}</button>
                `;
            }

            pagination.innerHTML += `
                <button class="pagination-btn" onclick="changePage('next')" id="nextBtn" ${currentPage === totalPages ? 'disabled' : ''}>Next →</button>
            `;
        }

        function goToPage(page) {
            const filteredDoctors = getFilteredDoctors();
            const totalPages = Math.ceil(filteredDoctors.length / doctorsPerPage);
            
            if (page >= 1 && page <= totalPages) {
                currentPage = page;
                loadDoctorFeed();
            }
        }

        function changePage(direction) {
            if (direction === 'prev' && currentPage > 1) {
                currentPage--;
                loadDoctorFeed();
            } else if (direction === 'next') {
                const filteredDoctors = getFilteredDoctors();
                const totalPages = Math.ceil(filteredDoctors.length / doctorsPerPage);
                if (currentPage < totalPages) {
                    currentPage++;
                    loadDoctorFeed();
                }
            }
        }

        function getOnlineDuration(startTime) {
            if (!startTime) return "0m";
            const now = new Date();
            const diffMs = now - startTime;
            const diffMins = Math.floor(diffMs / 60000);
            
            if (diffMins < 60) {
                return `${diffMins}m`;
            } else {
                const hours = Math.floor(diffMins / 60);
                const mins = diffMins % 60;
                return `${hours}h ${mins}m`;
            }
        }

        function initiateCall(doctorName, specialty) {
            document.getElementById('videoTitle').textContent = `Video Call - ${doctorName} & Medical Rep`;
            document.getElementById('videoContent').textContent = `📹 Connecting to ${doctorName} (${specialty})...`;
            document.getElementById('videoModal').style.display = 'block';
            
            currentUser.completedCalls++;
            updateQuotaDisplay();
            
            showNotification(`Connecting to ${doctorName}... Call will start in 3 seconds`, 'success');
            
            setTimeout(() => {
                document.getElementById('videoContent').textContent = `📹 Live call with ${doctorName}`;
            }, 3000);
        }

        // Doctor dashboard functions
        function toggleOnlineStatus() {
            const toggle = document.getElementById('statusToggle');
            const incomingCalls = document.getElementById('incomingCalls');
            
            if (!currentUser.isOnline) {
                currentUser.isOnline = true;
                currentUser.sessionStart = new Date();
                currentUser.sessionCalls = 0;
                
                toggle.textContent = '🔴 GO OFFLINE';
                toggle.classList.remove('offline');
                incomingCalls.style.display = 'block';
                
                startOnlineTimer();
                simulateIncomingCalls();
                
                showNotification('You are now ONLINE! Medical reps can see you and request calls.', 'success');
            } else {
                currentUser.isOnline = false;
                currentUser.sessionStart = null;
                
                toggle.textContent = '🟢 GO ONLINE';
                toggle.classList.add('offline');
                incomingCalls.style.display = 'none';
                
                stopOnlineTimer();
                clearCallRequests();
                
                showNotification('You are now OFFLINE. Call requests stopped.', 'info');
            }
        }

        function startOnlineTimer() {
            onlineTimer = setInterval(() => {
                if (currentUser.sessionStart) {
                    const duration = new Date() - currentUser.sessionStart;
                    const minutes = Math.floor(duration / 60000);
                    const seconds = Math.floor((duration % 60000) / 1000);
                    document.getElementById('sessionDuration').textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                }
            }, 1000);
        }

        function stopOnlineTimer() {
            if (onlineTimer) {
                clearInterval(onlineTimer);
                onlineTimer = null;
            }
            document.getElementById('sessionDuration').textContent = '0:00';
        }

        function simulateIncomingCalls() {
            if (currentUser.isOnline) {
                setTimeout(() => {
                    if (currentUser.isOnline) {
                        addCallRequest('Rajesh Kumar', 'Pfizer', 'Cardiac Stent Presentation');
                    }
                }, 5000);
                
                setTimeout(() => {
                    if (currentUser.isOnline) {
                        addCallRequest('Priya Singh', 'Cipla', 'Respiratory Care Products');
                    }
                }, 12000);
            }
        }

        function addCallRequest(repName, company, topic) {
            const callRequests = document.getElementById('callRequests');
            
            const requestDiv = document.createElement('div');
            requestDiv.className = 'call-request';
            requestDiv.innerHTML = `
                <div class="caller-info">
                    <div class="caller-name">${repName}</div>
                    <div class="caller-company">${company} - ${topic}</div>
                </div>
                <div class="call-actions">
                    <button class="accept-btn" onclick="acceptCall('${repName}', '${company}', this)">Accept</button>
                    <button class="decline-btn" onclick="declineCall(this)">Decline</button>
                </div>
            `;
            
            callRequests.appendChild(requestDiv);
            
            showNotification(`New call request from ${repName} (${company})`, 'info');
        }

        function acceptCall(repName, company, button) {
            currentUser.sessionCalls++;
            currentUser.earnings += 250;
            
            document.getElementById('sessionCalls').textContent = currentUser.sessionCalls;
            document.getElementById('todayEarnings').textContent = `₹${currentUser.earnings}`;
            document.getElementById('callsRemaining').textContent = Math.max(0, currentUser.sessionLimit - currentUser.sessionCalls);
            
            button.closest('.call-request').remove();
            
            document.getElementById('videoTitle').textContent = `Video Call - Dr. Ashwin & ${repName}`;
            document.getElementById('videoContent').textContent = `📹 Live call with ${repName} from ${company}`;
            document.getElementById('videoModal').style.display = 'block';
            
            showNotification(`Call started with ${repName}. Earning ₹250 for this consultation.`, 'success');
            
            setTimeout(() => {
                if (document.getElementById('videoModal').style.display === 'block') {
                    closeVideoModal();
                    showNotification('Call completed automatically after 4 minutes. Payment credited.', 'info');
                }
            }, 240000);
        }

        function declineCall(button) {
            button.closest('.call-request').remove();
            showNotification('Call request declined', 'info');
        }

        function clearCallRequests() {
            document.getElementById('callRequests').innerHTML = '';
        }

        function setSessionLimit(limit) {
            currentUser.sessionLimit = parseInt(limit);
            document.getElementById('callsRemaining').textContent = Math.max(0, currentUser.sessionLimit - currentUser.sessionCalls);
            showNotification(`Session limit set to ${limit} calls`, 'info');
        }

        // Video call functions
        function toggleScreenShare() {
            const shareBtn = document.getElementById('shareScreenBtn');
            const screenShareOverlay = document.getElementById('screenShareOverlay');
            
            if (!screenShareOverlay.classList.contains('active')) {
                shareBtn.textContent = '🛑 Stop Sharing';
                shareBtn.classList.add('btn-danger');
                screenShareOverlay.classList.add('active');
                showNotification('Screen sharing started', 'success');
            } else {
                shareBtn.textContent = '📺 Share Screen';
                shareBtn.classList.remove('btn-danger');
                screenShareOverlay.classList.remove('active');
                showNotification('Screen sharing stopped', 'info');
            }
        }

        function toggleMute() {
            showNotification('Microphone toggled', 'info');
        }

        function toggleCamera() {
            showNotification('Camera toggled', 'info');
        }

        function endCall() {
            closeVideoModal();
            showNotification('Call ended successfully', 'info');
        }

        function closeVideoModal() {
            document.getElementById('videoModal').style.display = 'none';
            document.getElementById('screenShareOverlay').classList.remove('active');
            document.getElementById('shareScreenBtn').textContent = '📺 Share Screen';
            document.getElementById('shareScreenBtn').classList.remove('btn-danger');
        }

        // Filter functions
        function filterBySpecialty(specialty) {
            selectedSpecialty = specialty;
            currentPage = 1; // Reset to first page when filtering
            loadDoctorFeed();
            const displayName = specialty === "all" ? "All Specialties" : capitalize(specialty);
            showNotification(`Filtered by specialty: ${displayName}`, 'info');
        }

        function filterByHospital(hospital) {
            selectedHospital = hospital;
            currentPage = 1; // Reset to first page when filtering
            loadDoctorFeed();
            const displayName = hospital === "all" ? "All Hospitals" : capitalize(hospital);
            showNotification(`Filtered by hospital: ${displayName}`, 'info');
        }

        function filterByStatus(status) {
            selectedStatus = status;
            currentPage = 1; // Reset to first page when filtering
            loadDoctorFeed();
            const displayName = status === "all" ? "All Status" : capitalize(status) + " Only";
            showNotification(`Filtered by status: ${displayName}`, 'info');
        }

        function capitalize(text) {
            if (!text || text === "all") return text;
            return text.split(' ').map(word => 
                word.charAt(0).toUpperCase() + word.slice(1)
            ).join(' ');
        }

        // Notification system
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'success' ? '#4CAF50' : type === 'info' ? '#2196F3' : type === 'warning' ? '#FF9800' : '#f44336'};
                color: white;
                padding: 15px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 1000;
                max-width: 300px;
                font-size: 14px;
                line-height: 1.4;
            `;
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 4000);
        }

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            loadDoctorFeed();
            updateQuotaDisplay();
            
            setInterval(() => {
                const todayCalls = document.getElementById('todayCalls');
                const currentCalls = parseInt(todayCalls.textContent);
                if (Math.random() > 0.7) {
                    todayCalls.textContent = currentCalls + 1;
                }
            }, 30000);
            
            window.onclick = function(event) {
                const modal = document.getElementById('videoModal');
                if (event.target == modal) {
                    modal.style.display = 'none';
                }
            }
        });
    </script>
</body>
</html>